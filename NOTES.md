# REACT/REDUX COURSE

## Section 4: Putting Redux to Practice

#### Lesson 39

### Reducers

> A Reducer is a _function_ that returns a piece of the application sate.

Because there are many pieces of state, there can be many reducers.

So in book application diagram there are two pieces of state:

1. List of books
2. Currently selected book

There are two reducers, each responsible for producing one of these.

```
// Application State - Generated by reducers
{
  books: [ { title: 'Harry Potter'}, {title:'Javascript"}],  
  activeBook: { title: 'Javascript: The Good Parts" }
}
```
In this example there is a _Books_ Reducer and an _ActiveBook_ Reducer, each producing a separate piece of state.

**NOTE**: Keys can be whatever we want, the Reducer is only convinced with the _value_ of state.

>To use a Reducer:
>1. Create the Reducer
>2. Wire it into the application

We did step 1 in `src/reducers/reducer_books` and step 2 in `src/reducers/index.js` by modifying `rootReducer` (this will be explored later). Note that we did not name the component in the file, and instead did `export default` so the consuming file (`index`) could name the component as it pleases.

#### Lesson 40

When we pass the object to `combineReducers` we tell Redux how to create our application state. At the early point, our app has a single piece of state called `books` where the value is whatever is returned from the `BooksReducer` function.

Connecting React and Redux is done with a library called _`ReactRedux`_. It allows us to define a component as a `Container` instead of a `Component`. 

> ### ReactRedux:
> A `Container` is a React component that has a _direct connection to the state_ managed by Redux.

But... which components are promoted to Containers, and which are left as regular React Components?

#### Lesson 41

In general, we want the _first parent component_ that cares about a piece of state to be a Container. So our book list and book detail should be Containers ("smart" component) while our `app` should be a "dumb" component (no connection to a piece of state).

#### Lesson 42

We wrote a function called `mapStateToProps()`. Whatever it returns will show up as `this.props` on the container. The application `state` is passed in. `state` has two props, `books` and `activeBook`. We want to assign `books` from the app `state` to the `books` prop in the `book-list` component.

> ### ReactRedux:
> Whenever we make a Container file, we want to export the container:  
> `export default connect(mapStateToProps)({{Component}})`

Note that there are two sets of parentheses on the `connect` call; it is two separate calls.

#### Lesson 43

Review of what we've done:

>&bullet; Remember that __Redux__ constructs the _application state_, __React__ provides the _views_ to display that state. 
>
>&bullet; React and Redux are inherently _disconnected_, and it is only through the use of __ReactRedux__ that we get any connection between the two.
>
>&bullet; Application state is generated by _Reducer functions_. 
> - Our `books` reducer always returns the same array; an array of objects where each object represents one book.
> - We added the `books` reducer to the `combineReducers()` call in `reducers/index.js`. 
> - This adds a key to the global app state called `books`.
> - The value of the `books` key is whatever gets returned by the `books` reducer (in this case, the array of books).
>
>&bullet; _Containers_ are components that are aware of state
> - Our `book-list` started as a component, but got promoted to a _Container_ in order to be aware of state
> - We promoted it by importing the `connect` function from `ReactRedux` and then defining `mapStateToProps()` 
> - Only `book-list` really cares about the list of books; the app doesn't really care
>
>### &bullet; Whenever application state changes, the Container _will re-render as well._

#### Lesson 44

At this point, our app state is static: Our `books` reducer can only return the same book list every time.

We will need app state to be dynamic. Changing state is what _actions_ and _action creators_ are for.

> Most everything in a Redux app starts off with an _event_ triggered by a user:
>- Clicking on a button
>- Selecting an item from a dropdown
>- Hovering
>- AJAX request finishing
>- Page finishing loading  

All of these events can call an _action creator_
- This is a function that returns an object.
- This object is an _action_ 
  - It has a `type` describing the type of action triggered (such as `BOOK_SELECTED`)
  - It also can have data (such as a `book` object)

The action is automatically sent to all reducers.

>Reducers can return a different piece of state depending on the action.  
>Such as:
>```
>switch (action.type) {
> case BOOK_SELECTED:
>    return action.book
> default:
>    return currentState
>}
>``` 
>This new piece of state gets piped into the app state.
>- New app state gets piped back into the app
>- All components will re-render